<context>

    <sample>
        <item value="Кто такая Алиса"/>
        <item value="Что такое бот"/>
    </sample>

    <input pattern="* (привет*|здравствуй*) *">
        <output if="full($UserName)">
            <item value="Привет, $UserName! Рада снова видеть тебя!"/>
            <item value="Здравствуй, $UserName! Я уже успела соскучиться..."/>
        </output>

        <context if="empty($UserName)" id="name">
            <output value="Привет! Меня зовут Алиса! А это - демонстрация моего навыка, созданного с помощью платформы zenbot. Как тебя зовут?"/>

            <input pattern="$Text">
                <var name="UserName" value="cap($Text)" scope="user"/>
                <output value="Приятно познакомиться, $UserName! Напиши мне что-нибудь."/>
                <context/>
            </input>
        </context>
    </input>

    <input pattern="* пока *">
        <output value="Ну пока, незнакомец!" if="empty($UserName)"/>
        <output value="Пока-пока, $UserName!"/>
    </input>

    <input pattern="[* (кто|что) так*] $Text">
        <get url="http://ru.wikipedia.org/w/api.php" var="Wiki" if="full($UserName) and full($Text)">
            <param name="format" value="xml"/>
            <param name="action" value="opensearch"/>
            <param name="search" value="$Text"/>
        </get>

        <var name="Items" value="javascript: $Wiki['SearchSuggestion']['Section']['Item']" if="full($Wiki)" scope="context"/>

        <context id="name" if="empty($UserName)"/>

        <context if="full($Result)" id="result">
            <var name="Result" value="javascript: $Result[Math.floor(Math.random() * $Items.length)]['Description']['content']"/>
            <output value="$Result" if="full($Result)"/>

            <input pattern="* (еще|другой вариант) *">
                <context id="result"/>
            </input>

            <sample value="Другой вариант"/>
        </context>

    </input>

</context>